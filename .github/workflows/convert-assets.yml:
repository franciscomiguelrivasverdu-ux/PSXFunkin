name: DEBUG Convert Assets

on:
  push:
    branches: [ master ]
  workflow_dispatch:

jobs:
  debug:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: DEBUG - List ALL files
      run: |
        echo "ðŸ” LISTANDO TODOS LOS ARCHIVOS:"
        find iso/ -type f | head -20
        echo ""
        echo "ðŸŽµ ARCHIVOS WAV ESPECÃFICAMENTE:"
        find iso/ -name "*.wav"
        echo ""
        echo "ðŸ“ ESTRUCTURA COMPLETA:"
        ls -la iso/
        ls -la iso/week1/ 2>/dev/null || echo "âŒ No existe week1/"
        
    - name: DEBUG - Test conversion
      run: |
        if find iso/ -name "*.wav" | grep -q .; then
          echo "âœ… WAV ENCONTRADO - Probando conversiÃ³n..."
          find iso/ -name "*.wav" | while read wav_file; do
            echo "Convirtiendo: $wav_file"
            ffmpeg -i "$wav_file" test_output.xa 2>&1 | head -5
          done
        else
          echo "âŒ NO SE ENCONTRÃ“ NINGÃšN WAV"
        fi        echo "âœ… CONVERSIÃ“N EXITOSA" > conversion-success.txt
        echo "Archivos WAV encontrados:" >> conversion-success.txt
        find iso/ -name "*.wav" >> conversion-success.txt
        echo "" >> conversion-success.txt
        echo "Archivos XA generados:" >> conversion-success.txt
        find iso/ -name "*.xa" >> conversion-success.txt
        
    - name: Upload converted assets
      uses: actions/upload-artifact@v4
      with:
        name: converted-assets
        path: |
          iso/**/*.xa
          conversion-success.txt        echo "âœ… CONVERSIÃ“N EXITOSA" > conversion-success.txt
        find iso/ -name "*.xa" >> conversion-success.txt
        
    - name: Upload converted assets
      uses: actions/upload-artifact@v4
      with:
        name: converted-assets
        path: |
          iso/**/*.xa
          conversion-success.txt
